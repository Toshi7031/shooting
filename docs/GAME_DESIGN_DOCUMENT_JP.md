# ゲームデザインドキュメント - Circle Breaker Survivors

## 1. 概要
- **タイトル**: Circle Breaker Survivors
- **ジャンル**: ブロック崩し / サバイバー系ローグライク
- **エンジン**: Flutter + Flame
- **ステータス**: MVP（実用最小限の製品）完成済み

## 2. コアゲームプレイ
プレイヤーは画面端から迫りくる敵のウェーブから中央の **コア（拠点）** を防衛します。主な攻撃手段は、敵や壁に反射する **ボール** です。

### コア（Core）
- **位置**: 画面中央（レスポンシブ対応）。
- **HP**: 100（初期値）。0になるとゲームオーバー。
- **攻撃**: **最も近い敵** を自動的に狙って（オートエイム）ボールを発射します。
- **弾薬（Loadout）**: 所持しているボール（アイテム）を順番に発射します。

### ボール（Balls）
- **物理挙動**: 壁（画面4辺）すべてで跳ね返ります。初期状態では **1回** 跳ね返ると消滅（コアに戻る）します。
- **ボール制限（Bounce Limit）**: レベルアップで跳ね返り回数を強化可能。
- **種類**:
    - **Iron Ball**: 通常のボール。
    - **Vampire Orb**: キル時にコアHPを回復。
    - **Blast Orb**: 爆発して範囲ダメージ。
- **ダメージ**: タグの倍率（物理、炎、冷気）に基づいて計算されます。
- **挙動**:
    - **貫通（Pierce）**: 敵を貫通してダメージを与え続けることができます。
    - **軌跡（Trails）**: 速度と進行方向を視覚的に示します。

### 敵（Enemies）
- **ブロックエネミー**: 通常の敵。コアに向かって直線的に移動します。
    - HP: `10 + (Wave数 * 2)`
- **Rare敵（Modded）**: **Wave 3以降**、20%の確率で出現。黄色く光る見た目。
    - **Mod**: 1〜2個のMod（Haste, Giant, Enraged, Armored）を持つ。
    - **Modの効果**: 移動速度UP、サイズ/HPUP、自爆ダメージUP、被ダメージ減少。
- **ボスエネミー**: **5ウェーブごと** に出現します。
    - **ステータス**: 超高耐久。HPは `Wave数 * 2000`。
    - **見た目**: 巨大な紫色の独自のピクセルアート。
    - **ドロップ**: 大量のXPとゴールド。

## 3. 進行システム

### ウェーブシステム
- 敵はウェーブ単位で出現します。
- **ウェーブクリア**: すべての敵を倒すと次のウェーブに進みます。
- **スケーリング**: ウェーブごとに敵の出現数が `50 + (Wave * 10)` ずつ増加します。

### RPG・進行要素
- **XP（経験値）**: 敵を倒すと獲得でき、「アップグレードポイント」が蓄積されます。
- **手動レベルアップ**: **ゲームは止まりません**。画面下の「UPGRADE」ボタンから任意のタイミングで強化を行います。
- **アップグレード**:
    - **物理 / 炎 / 冷気ダメージ**: +20% ダメージ倍率。
    - **攻撃速度（Attack Speed）**: 発射間隔を短縮。
    - **貫通（Pierce）**: ボールが貫通できる敵の数を増加。
    - **跳ね返り（Bounce）**: 壁での跳ね返り回数を+1増加。

### アーティファクト（Artifacts）
装備することでパッシブ効果を得られる特殊アイテム（最大3枠）。

**Unique（ユニーク）**:
- **Headhunter**: Rare敵を倒すと、そのModを20秒間盗む。
- **Tabula Rasa**: 全てのダメージタグに+20%ボーナス。

**Rare（レア）**:
- **Soul Eater**: 敵を倒すとHP+1回復。
- **Berserker's Rage**: HP50%以下でダメージ+50%。
- **Lucky Charm**: ゴールドドロップ+50%。

### 経済（ゴールド）
- **入手**: 敵がドロップします。
- **ショップ**: UIの「SHOP」ボタンからアクセス可能（ボトムシート形式）。
    - **ボール購入**: 「Vampire Orb」「Blast Orb」などの特殊なボールを購入可能。
    - **回復**: コアのHPを50回復（コスト: 50G）。
    - **ランダム強化**: ランダムなステータス強化（ダメージ倍率）を購入（コスト: 200G）。

## 4. UI & 操作

### メインHUD
- **XPバー**: 画面上部。
- **HPバー**: 画面下部。
- **ウェーブ / ゴールド**: 上部隅。

### 下部パネル
- **UPGRADE**: 赤いバッジでポイント数を表示。タップで強化メニューを開く。
- **SHOP**: ショップメニューを開きます。
- **MENU**: ポーズメニューを開きます。

### ポーズメニュー
- 現在のステータス（レベル、ゴールド、ダメージ倍率など）を表示します。
- ゲームの全ロジック（スポーン、移動など）を一時停止します。

## 5. 技術詳細
- **画面**: フルスクリーン・レスポンシブ対応。
- **オーディオ**: カスタム `AudioManager` によるBGMループ再生と多重SE再生。
- **グラフィックス**: 基本図形は `Canvas` 描画、ボールは生成されたピクセルアート画像を使用。
